
\chapter*{Kurzfassung}
\addcontentsline{toc}{chapter}{Kurzfassung}
\selectlanguage{german}

Das USB-Protokoll implementiert keine Authentifizierungsmassnahmen f\"ur USB-Peripherieger\"ate. Das erm\"oglicht die Imitation von Eingabeger\"aten (Human Interface Devices) und erlaubt es jeglichen USB-Ger\"aten vorzugeben, ein solches Eingabeger\"at zu sein und dem Computer Befehle zu erteilen. Solche Attacken werden HID-Imitationsangriffe genannt und haben das Potenzial, grossen Schaden anzurichten. Sogenannte BadUSB k\"onnen frei Befehle an Computer senden, wie es auch ein Mensch mit physischem Zugriff k\"onnte, allerdings mit dem Vorteil \"ubermenschlicher Geschwindigkeit, erm\"oglicht durch die eingebauten Mikrocontroller. Ihr gr\"osster Nachteil jedoch sind die fehlenden R\"uckmeldungen, um einsch\"atzen zu k\"onnen, ob die abgegebenen Befehle erfolgreich waren.

Diese Arbeit erkundet die Geschichte solcher Angriffe sowie die Evolution der Massnahmen gegen sie. Zudem setzt sie einen Schwerpunkt auf ein spezifisches BadUSB: das O.MG-Kabel. Sie analysiert die bestehenden Angriffsskripte, die \"uber die offizielle O.MG GitHub-Datenbank verf\"ugbar sind, und gleicht sie mit den Methoden ab, die im MITRE ATT\&CK Framework gelistet sind. Zu einigen unter- oder nicht repr\"asentierten Methoden werden anschliessend sieben neue Angriffe beschrieben und entwickelt. Zus\"atzlich wird der Aufbau und die Implementierung eines Verteidigungsprogramms detailliert beschrieben, das einen neuartigen Ansatz zur Erkennung von O.MG-Ger\"aten aufgrund ihrer USB-Registrierungsmuster beinhaltet. Weiterhin besteht es aus einem Ratenbegrenzer mit zwei Modi: einer Analyse der Zeitabst\"ande zwischen Tastendr\"ucken und einer Analyse der Anzahl der Tastendr\"ucke in einer gesetzten Zeitspanne. Sobald verd\"achtige Aktivit\"at bemerkt wird, trennt das Programm die Verbindung.

Diese Implementationen werden anschliessend evaluiert. Daf\"ur werden die Angriffsskripte auf drei verschiedenen Ger\"aten ausgef\"uhrt und aufgrund ihres Erfolgs beurteilt. Sie wurden ebenfalls gegen das Verteidigungsprogramm getestet, um herauszufinden, wie schnell dieses sie unterbrechen w\"urde.

Es wurde festgestellt, dass einige Skripte flexibler und weniger anf\"allig f\"ur unvorhergesehene Hindernisse sind und daher weniger Anpassungen brauchen. Zudem wurde festgestellt, dass die Registrierungsmusteranalyse sowie der Ratenbegrenzer zuverl\"assig Angriffe erkennen und abbrechen. Die effizienteste Konfiguration f\"ur die Analyse der Zeitabst\"ande ist ein Schnitt von 8 Millisekunden \"uber drei Tastendr\"ucke, w\"ahrend es f\"ur die Zeitfensteranalyse zwei Tastendr\"ucke in einer Zeitspanne von 75 Millisekunden ist.

\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

\selectlanguage{english}

The USB protocol does not implement authentication measures for USB peripheral devices. This leaves room for Human Interface Device Spoofing, specifically for USB
devices pretending to be HID and injecting commands to a host. Those attacks are called
HID spoofing attacks and have the potential to wreak havoc on a target computer. Such a
BadUSB has all the capabilities of a human with physical access to the deviceâ€™s HID, but
with the added advantage of superhuman input speeds provided by its microcontrollers.
However, its main limitation is the lack of feedback mechanisms to assess the outcomes
of its actions. 

This thesis explores the history of such attacks as well as the history of
countermeasures against them. Additionally, it focuses on one commercially available BadUSB: the O.MG cable. It analyses existing attack payloads on the official O.MG
GitHub repository, comparing them to the MITRE ATT\&CK framework and supplementing it with seven new ones. Furthermore, the architecture and implementation of a
defence script are described. The defence features a novel approach by detecting O.MG devices through their special enumeration patterns. It also consists of a rate limiter with two modes; Interarrival Time Analysis, which detects suspicious input speeds by the delay between key presses,
and Time Window Analysis which detects artificially generated input by setting a threshold for the number of maximal keypresses within a specific time frame. The script disconnects the input
device as soon as any suspicious behaviour is detected through the previously described
methods.

These implementations are then evaluated. The payloads are tested on three different devices while the three-part detection script is evaluated by how quickly it can detect these
novel payloads. It was found that some payloads are more flexible than others and some of
their features make them more or less prone to failure due to unexpected circumstances and therefore require fewer adjustments to work. Furthermore, it was found that the Enumeration Pattern Analysis works reliably and quickly as do the Rate Limiter modes. The most effective configuration for Interarrival Time Analysis is found to be 8 milliseconds averaged over 3 recorded keystrokes while it is two keystrokes in a window of 75 milliseconds for Time Window Analysis.

