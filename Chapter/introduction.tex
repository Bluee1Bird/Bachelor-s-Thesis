\chapter{Introduction}

\section{Motivation}

multiple attack 

placing incriminating info

geofencing
self destruction
keymapper
data manipulation
password stealing
phising

Credentials have been misused, the network infiltrated, and the spreadsheet altered. It looks like the company was infiltrated by a corporate spy, their long-standing, seemingly loyal employee turned on them and executed a series of malicious attacks on the company spanning over multiple days, stealing information and planting incriminating evidence against her employer. Everything points to her, the logs show that the activity came from her account, no traces of malpractice, viruses, or trojans were found on her machine, yet she asserts over and over that she is innocent. \\
No one suspects that this is the doing of a small, innocent-looking USB Cable the employee received for free at a work convention. This cable is a type of BadUSB, although it poses as harmless and cannot be distinguished from any other cable the employee or her bosses have ever seen, it wreaked havoc and started the attack as soon as the employee plugged it in. \\
She used the handy cable to replace the damaged and old one connecting her external keyboard to her work computer. As soon as the malicious O.MG cable was connected it sprung into action. The boot script executed and checked the available Wi-Fi networks. Once it concluded that it was in the right spot by identifying the target Wi-FI, it sent a signal to the remote Command and Control (C\&C) server that it was in place and ready to be used. While it waited for further instructions, it diligently, for weeks, transmitted every keystroke signal the employee typed on her external keyboard not only to the laptop but also to the C\&C server. These keystrokes contained credentials, emails, names, notes, and a lot of information about user behaviour. Starting one day, after the employee had left her desk and locked her Windows machine without shutting it off, the cable sprang into action again. From the data it had gathered, it knew about the daily habits of the employee and her break times and over the span of a few breaks, it executed a series of attack scripts. It knew her keyboard layout, which was important because it went on to simulate keystrokes on that very keyboard. Using the logged credentials, it unlocked the computer and started executing the payloads it was sent from its control server on the other side of the plant, inputting up to 890 keystrokes per second, executing commands, extracting information from the laptop, infiltrating the network, placing spyware, and altering information on the host, all while pretending to be the employee working through her break. To avoid detection, it disabled Windows Event Logging and ran processes as background jobs. By the time the employee came back, all that gathered information was sent to the C\&C server and the attackers were able to move on laterally, infiltrating more and more of the company's systems. At the end of their attack series, they destroyed the last remaining indicator of the attack, the cable itself. They used the self-destruct feature to disable not only its malicious capabilities but also its data-transmitting abilities. As a result, the employee thought the cable had broken, it was just a PR gift, after all, got a new one and threw it out. With that, she got rid of the only evidence she had to prove that it had not been her executing all those attacks.

....

\section{Description of Work}

This thesis aims to shed light on the history of keyboard injection attacks by examining the past of different attack approaches by various actors as well as the responses they triggered and the multitude of defence approaches that were developed. Additionally, it focuses on developing new payloads for the O.MG cable that are not yet publicly listed on the official O.MG GitHub repository by analyzing the MITRE ATT\&CK framework and comparing its subtechniques to those already present. In a second step analyzes USB traffic generated by the O.MG cable to develop a novel detection mechanism and pairs those results with a rate limiter implementation that features two modes. Lastly, it evaluates the developed attacks and defences against each other.

\section{Thesis Outline}
The content of this thesis is split into six chapters. Chapter 2 will introduce the background for this thesis, and give a brief overview of USB and the technical knowledge necessary to understand the subsequent topics. Chapter 3 details the history of USB attacks as they apply to human interface spoofing and injection attacks. Chapters 4 and 5 cover the architecture and implementation of the new payloads and the defense script, detailing their functionalities and specific features. These implementations are evaluated in Chapter 6, which tests the payloads on different devices and ascertains the best configurations for the defence scripts to detect and interrupt O.MG payloads as quickly as possible.

\section{Ethical Considerations}
Attacks as described in this thesis can cause considerable harm to individuals, companies, and communities. For all the reasons explained and examples brought up in section \ref{TheDangersOfUSB} these attacks are not to be taken lightly and the potential for damage is real. For this exact reason, it is important to raise awareness for this kind of attack, research existing vulnerabilities, new developments in the field, and how those can be counteracted. Investigating attacks in particular ones that are not available in a public GitHub repository is an important contribution to the scientific field and outweighs the negative. Just because these payloads cannot easily be found, does not mean they do not already exist. Which arguably makes them even more dangerous to the public and therefore their exploration is even more urgent. \\
In section \ref{HistoryOfDefense} this thesis explains countermeasures that can be put in place to protect oneself and in section \ref{Defence Methodology} a defence architecture will be presented, specifically against the O.MG cable introduced in section \ref{Background}.
% bring up the black/white /grey hat discussion again? or is his not scientific enough?

